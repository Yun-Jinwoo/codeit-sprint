# 리액트에서 Virtual DOM이 무엇인지, 이를 사용하는 이유는 무엇인지 설명해 주세요.

## 🐤 Virtual DOM

**Virtual** 은 ‘실제로 존재하는 것이 아닌’ , 즉 ‘가상의' 라는 뜻으로 해석할 수 있고

**DOM** 은 Document Object Model 으로, 브라우저 상에서 javascript로 HTML 문서를 조작하기 위한 API 이다.

**즉, Virtual DOM** 은 DOM을 가상으로 만든 것, 즉 js로 html을 조작하기 위한 객체를 허상으로 만든 것이라고 해석할 수 있겠다.

**그럼, React는 왜 DOM을 가상으로 만들어서 사용할까??**

## **⚙️ Virtual DOM의 기본 원리**

![image.png](attachment:6c1e0645-e9e6-4d52-9cf9-df3ab9f38f42:image.png)

Virtual DOM의 원리는 아래와 같다.

<aside>

1. real dom으로부터 virtual dom을 만든다
2. **변화**가 생기면 새로운 버전의 virtual dom을 만든다.
3. old 버전의 virtual dom과 new 버전의 virtual dom을 비교한다.(diff algorithm)
4. 비교 과정을 통해서 발견한 차이점을 real dom에 적용한다.
</aside>

이러한 과정을 **reconciliation** 이라고 부른다.

이 과정 중 2번에서, “**변화**가 생기면 새 버전의 virtual dom을 만든다.” 라고 했는데,
**이 변화는 어떻게 감지할 수 있을까?**

## ↔️ 변화를 감지하는 방법

특정 node에 변화가 생길 때, 리렌더링이 발생한다. 그럼, 이 변화를 감지하는 방법은 무엇이 있을까?

### **1. Dirty Checking**

node tree를 재귀적으로 계속 순회하면서, 어떤 노드에 변화가 생겼는지 인식하는 방법
순회 후 변화가 생긴 노드를 찾았다면, 그 노드만 리렌더링을 시키면 된다!

### ⚠️ **Dirty checking의 문제점**

허나, 이 방법은 변화가 없을 때도 재귀적으로 노드를 탐색하므로, 불필요한 비용이 발생하며, 성능적인 측면에서도 문제가 있다.

### **2. Observable**

변화가 생긴 노드가 관찰자에게 알림을 보내주는 방식

React의 경우, state에 변화가 생기면, React에게 렌더링을 해줘야 한다고 알려주는 방식
알림을 받으면, React는 렌더링을 진행함

이 방식을 사용하면, 변화가 생기기 전에는 따로 작업이 필요하지 않다.
즉, **노드에게 변화가 생겼다는 알림을 받으면 렌더링을 진행한다.**

### ⚠️ **Observable의 문제점**

노드에게 변화가 생겼다는 알림을 받으면? **DOM** **전체를 렌더링 시킨다.
이로 인해 엄청난 reflow-repaint 비용이 발생한다.**

### 🛠️ **Virtual DOM으로 해결하자!**

위 문제를 해결하기 위해 Virtual DOM이 등장했다!

Virtual DOM은 메모리 상에 존재하는 하나의 객체이다.
따라서, React는 특정 state에 변화가 생겼다는 알림을 받으면
**➡️ Real DOM 전체를 렌더링 시키지 않고, Virtual DOM을 렌더링 시킨다.**

브라우저 전체를 렌더링 시키는 비용보다 Virtual DOM 객체를 새로 만드는 비용이 더 저렴하기 때문에 가능한 것!!

추가적인 부분은 [이 글](https://velog.io/@yesbb/virtual-dom%EC%9D%98-%EC%84%B1%EB%8A%A5%EC%9D%B4-%EB%8D%94-%EC%A2%8B%EC%9D%80%EC%9D%B4%EC%9C%A0)을 확인하시면 좋습니다!

# 리액트에서 배열을 렌더링할 때 key를 써야 하는 이유에 대해 설명해 주세요.

## 🔑 key

key는 각 항목을 구별할 수 있도록 도와주는 **유일한 식별자**

## ❓ React 배열에 key를 사용하는 이유?

리스트의 **각 항목을 효율적으로 업데이트** 하기 위함!!

### **1️⃣ 가상 DOM이 변경 사항을 빠르게 감지**

React는 state가 변경될 때 Virtual DOM에서 변경 사항을 비교하고 최소한의 연산으로 실제 DOM을 업데이트한다.

만약 `key`가 없으면? ➡️ React는 리스트 전체를 새로 렌더링해야 함!!

`key`가 있으면? ➡️ 변경된 항목만 업데이트하면 됨!!

### **2️⃣ 리스트 항목의 순서가 바뀌거나 추가/삭제될 때 문제 방지**

만약 `key`가 **없으면** React는 **인덱스를 기반으로 변경을 감지**하려고 하는데,
요소가 추가/삭제되면 기존 요소들의 위치가 바뀌면서 예기치 않은 UI 오류가 발생할 수 있음!

즉, React에서 배열을 렌더링해야 한다면, **성능을 위해서,** 그리고 **예기치 않은 오류를 방지**하기 위해서 꼭 Key를 사용해야 한다!
